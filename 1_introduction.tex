\part{Introduction}
In satellite applications, radio communication is the most important method for controlling the satellite state and issuing any commands to it. 

\chapter{Aim of the thesis}
The aim of this thesis was to design, test \& deploy communication system for second Polish satellite, PW-Sat2. This work covers phases of component selection \& design, testing all the subsystems and finally results from the on-orbit mission.

\chapter{PW-Sat2}
    The presented system was design specifically to be deployed on-board the PW-Sat2 satellite \cite{PW-Sat2URL}. PW-Sat2 was launched on Low Earth Orbit or 3rd of December 2018 on-board Falon9 rocket from SpaceX company.

    In the figure \ref{PW-Sat_render_01} an exploded render of PW-Sat2 is presented.
    
    %%% [TODO]: JAKIEŚ ZDJĘCIA

    \begin{figure}[H]
        \centering
        \includegraphics[width=0.65\paperwidth]{img/4/PW-Sat2_render_01.png}
        \caption{PW-Sat2 render. Source: \cite{PW_sat2_photo}}
        \label{PW-Sat_render_01}
    \end{figure}


    \section{Primary mission}
    % skopiowane z inż, do przepisania
        The primary mission of PW-Sat2 is to test the deorbit sail. When satellite mission ends, it has to be safely deorbited (or moved to graveyard orbit). Due to new regulations, satellite has to be removed from
        the LEO region no later than 25 years after the end of vehicle operations \cite{Satellite_disposal}. Purpose of deorbit sail is, after satellite operations, to open and increase atmospheric drag, shortening satellite life and cause deorbitation. More information about this experiment can be found in \cite{DDC_article}.

        A render of PW-Sat2 with opened sail is shown in the figure \ref{PW-Sat_render_sail}.

        \begin{figure}[H]
            \centering
            \includegraphics[width=0.38\paperwidth]{img/4/PW-Sat2_render_02.png}
            \caption{PW-Sat2 with opened sail. Source: \cite{PW_sat2_photo}}
            \label{PW-Sat_render_sail}
        \end{figure}

    \section{Mission plan and system lifetime}
        PW-Sat2 mission was divided into two phases: normal \& extended mission. Normal phase was planned to take 40 days, after which the deorbitation phase and extended mission begin. Deorbitation can  take up two two years, during which its state along with satellite housekeeping should be monitored.

    \section{Orbit}
        PW-Sat2 in planned to be launched to a sun-synchronous circular orbit of attitude \SI{575}{\kilo\meter}, with LTAN of 10:30 \cite{PWSAT_MA_CDR}.

\chapter{Subsystem review}
There are number of commercially available solutions and subsystems. Usually they are divided into subsystems, allowing user to mix different suppliers depending on the requirements, assuring they are compatible.

\section{Cubesat commmunication diagram}
Typical Low Earth Orbit satellite communication systems is shown in the figure \ref{comm_diagram}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.7\paperwidth]{img/1/comm_diagram.eps}
    \caption{General communication system diagram}
    \label{comm_diagram}
\end{figure}

It consists of:
\begin{enumerate}
    \item On-Board Computer - controls the satellite, generates data and receives telecommands,
    \item Telemetry/Telecommand generator - translates between packets and baseband signal (modulator and demodulator),
    \item COMM - communications module, performs up/down conversion, amplification and antenna matching, usually on smaller missions it is integrated with TMTC on one module,
    \item Satellite antenna(s), typically omnidirectional to provide coverage during random satellite tumbling
    \item Ground station antenna(s), directional to maximize gain of the radio link,
    \item RADIO - radio system, typically a low noise amplifier with up/down converter and modulator, converts radio frequencies to baseband signals,
    \item Terimnal Network Controller - translates between packets and baseband signal, can be done as a separate device or in software in the PC,
    \item PC - a computer, which operator of the satellite uses to generate and receive data packets.
\end{enumerate}

\section{Cubesat antennas}
Cubesat dimensions are strict and defined in the CubeSat Design Specification \cite{cubesat_spec} as \si{100}x\si{100}~mm square \ref{CubeSat_max_dim}. This poses a requirement of antenna unfolding for antennas larger than side width. Usually this is required for all sub-GHz band, such as considered VHF and UHF bands. Higher bands, such an S-band, usually use patch antennas mounted on the wall.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\paperwidth]{img/1/cubesat_dimensions.eps}
    \caption{CubeSat maximum dimensions, top view. Source \cite{cubesat_spec}.}.
    \label{CubeSat_max_dim}
\end{figure}

Antennas are usually unfolded by the spring action of the antennas itself and they are released by the on-board computer (by the thermal knife). Three typical antenna deployment systems are shown in the figures \ref{stiff_antenna_pic}, \ref{m_cubed}, \ref{isis_dipole_antenna}.

Typical unidirectional VHF/UHF antennas are dipoles, monopoles or turnstille. Selecting one depends on the mission requirements and link budget. Turnstille antenna, providing best link budget and circular polarization require that radiation elements are mounted on two sides of the CubeSat. Dipole option uses two elements is not as dependent on the ground reference (main structure) as the monopole antenna.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\paperwidth]{img/1/antenna_stiff.png}
    \caption{Deployed stiff antenna. In the stowed configuration they are along the solar panels. Source \cite{stiff_antenna_paper}.}.
    \label{stiff_antenna_pic}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\paperwidth]{img/1/m-cubed.jpg}
    \caption{Tape measure antenna in the stowed configuration. Flat spring action forces antenna to deploy itself after its release. Source \cite{m_cubed}.}.
    \label{m_cubed}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\paperwidth]{img/1/isis_dipole.png}
    \caption{Flat spring antennas rolled inside the CubeSat square. Released by the thermal knife burning the lock of the antenna doors. Source \cite{isis_dipole_antenna}.}.
    \label{isis_dipole_antenna}
\end{figure}

\section{Ground station antennas}
Space communication antennas require very large gain due to the distance between the stations and the omnidirectivity of the CubeSat antennas. Transmit power of the satellite is usually rather low (\SI{1}{\watt} or less).

Most of the designs use Yagi-Uda antennas, in circular polarization (cross-yagi with phasing). They are typically 9-11 elements long for VHF and 17-19 elements for UHF. Yagi-Uda antennas can be also phased as an array of antennas (1x2, 2x2 configuration etc.) improving gain and directivity. This however requires the antenna mast to withstand the size and weight of the system. Required power gain is dependent on the mission itself and the reliability of the link. Random tumbling and CubeSat antennas with dips in the radiation pattern (as monopole and dipole) require more directivity and power gain than attitude-controlled satellites. Direcitivity of the antenna also affects antenna noise temperature.

Depending on the mission, one, two or more antennas can be required due to the number of bands used. 

Due to the directivity of the antennas, their half-power beam width is around \si{2}-\SI{10}{\degree}. Therefore another required element of the ground station is the antenna rotator, which has to support the required weight, size and the location of the ground station.

In the figure \ref{isis_gs} the commercially available ISIS VHF/UHF ground station is shown, which employs two cross-yagi antennas (VHF, UHF), antenna mast and rotator and rotator controller.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\paperwidth]{img/1/isis_gs.jpg}
    \caption{ISIS Ground Station. Source \cite{isis_gs}.}.
    \label{isis_gs}
\end{figure}

\section{Satellite communication subsystem}
Communication subsystem of the satellite is responsible of transmitting and receiving radio signals, modulating/demodulating them and providing data link for the On Board Computer. It has to be compatible with selected mechanical configuration, available data interfaces and the antennas to be installed. Most of the designs use custom design radio systems, using heterodyne receivers/transmitters (Fig. \ref{clyde_comm}), however there are an Software-Defined Radio systems, such as Gomspace SDR Platform \ref{gomspace_comm}.

\begin{minipage}{\linewidth}
    \centering
    \begin{minipage}{0.45\linewidth}
        \begin{figure}[H]
            \centering
            \includegraphics[width=0.32\paperwidth]{img/1/clyde_comm.jpg}
            \caption{CPUT UTRX from Clyde Space. Source: \cite{clyde_comm}}
            \label{clyde_comm}
        \end{figure}
    \end{minipage}
    \hspace{0.05\linewidth}
    \begin{minipage}{0.45\linewidth}
        \begin{figure}[H]
            \centering
            \includegraphics[width=0.35\paperwidth]{img/1/gomspace_sdr.png}
            \caption{Space qualified Software Defined Radio (SDR) Platform. Source: \cite{gomspace_comm}}
            \label{gomspace_comm}
        \end{figure}
    \end{minipage}
\end{minipage}


\section{Ground segment communication subsystem}
\subsection{Transmitter}
Due to the typically lower sensitivity and omnidirectional antenna on the satellite the uplink EIRP has to be very large, requiring not only directional antennas but also high output power (\si{100}-\SI{1500}{\watt}).
Depending on the modulation required, relatively cheap radio amateur transceivers can be used to modulate and amplify transmit signals, such as ICOM 910H or KENWOOD TS-2000 E (Fig. \ref{kenwood_ts2000}). As those types of radios were designed to transmit speech (bandwidth up to about \SI{10}{\kHz}) they can be used only to transmit signals which are FM, AM or SSB modulated. For other modulation and/or bandwidth the radio signal has to be generated by other type of radio (integrated or software-defined) and power amplifier.

Depending on the required output power, high-power amplifier can be used to further increase output power up to several kilo-watts. 

\begin{minipage}{\linewidth}
    \centering
    \begin{minipage}{0.45\linewidth}
        \begin{figure}[H]
            \centering
            \includegraphics[width=0.35\paperwidth]{img/1/kenwood_ts2000.jpg}
            \caption{KENWOOD TS-2000 E all mode transceiver. Source: \cite{kenwood_ts2000}}
            \label{kenwood_ts2000}
        \end{figure}
    \end{minipage}
    \hspace{0.05\linewidth}
    \begin{minipage}{0.45\linewidth}
        \begin{figure}[H]
            \centering
            \includegraphics[width=0.35\paperwidth]{img/1/vhf_1500w_pa.jpg}
            \caption{\SI{1500}{\watt} VHF power amplifier. Source: \cite{vhf_1500w_pa}}
            \label{vhf_1500w_pa}
        \end{figure}
    \end{minipage}
\end{minipage}

\subsection{Receiver}
The receiver on the ground has to complement the space segment. Due to relatively low transmit power on the satellite, the receiver sensitivity should be very high. Additionally, receiver intermodulation performance should withstand possible blocking signals which are present on the ground.

To increase the sensitivity, Low Noise Amplifier has to be installed close to the antenna, such as LNA SSB-70 for UHF band (Fig. \ref{TODO}), which has Noise Figure of about \SI{0.35}{\dB}. Intermodulation and blocking is provided at the first stage by placing low-loss filter before the LNA, such as Cavity filters (Fig. \ref{cavity_uhf}).

\begin{minipage}{\linewidth}
    \centering
    \begin{minipage}{0.45\linewidth}
        \begin{figure}[H]
            \centering
            \includegraphics[width=0.3\paperwidth]{img/1/ssb_lna70.jpg}
            \caption{LNA SSB-70 Low Noise Amplifier for UHF band. Source: \cite{ssb_lna70}}
            \label{ssb_lna70}
        \end{figure}
    \end{minipage}
    \hspace{0.05\linewidth}
    \begin{minipage}{0.45\linewidth}
        \begin{figure}[H]
            \centering
            \includegraphics[width=0.2\paperwidth]{img/1/cavity_uhf.jpg}
            \caption{LBQ-450 3-cavity UHF bandpass filter. Source: \cite{cavity_uhf}}
            \label{cavity_uhf}
        \end{figure}
    \end{minipage}
\end{minipage}

Radio signal, pre-amplified by the low-noise amplifier is down-converted to the baseband and de-modulated. This can be performed by the integrated radio transceiver (same as the transmitter, this emposes the same modulation constraints as for the transmitter) or by the software-defined radio, such as an NI-USRP 2901 (Fig. \ref{ni_2901}) or FUNCube Dongle Pro+ (which was specifically designed for the FUNCube CubeSat - Fig. \ref{funcube}).

\begin{minipage}{\linewidth}
    \centering
    \begin{minipage}{0.45\linewidth}
        \begin{figure}[H]
            \centering
            \includegraphics[width=0.3\paperwidth]{img/1/ni_2901.png}
            \caption{USRP-2901 Software Defined Radio Device. Source: \cite{ni_2901}}
            \label{ni_2901}
        \end{figure}
    \end{minipage}
    \hspace{0.05\linewidth}
    \begin{minipage}{0.45\linewidth}
        \begin{figure}[H]
            \centering
            \includegraphics[width=0.3\paperwidth]{img/1/funcube.jpg}
            \caption{FUNCube Dongle Pro+. Source: \cite{funcube}}
            \label{funcube}
        \end{figure}
    \end{minipage}
\end{minipage}

After down-conversion baseband signal has to be de-modulated, which is done by the Terminal Network Controller. This can be implemeneted as a custom hardware solution (analog-to-digital converter and custom digital signal processor, for example TNC-X shown in the figure \ref{tncx}) or by pure software. Software solution has more flexibility but require a PC to perform signal processing, as is the only option for software-defined radio. One of the available TNC software using audio card is the Direwolf \cite{direwolf}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.3\paperwidth]{img/1/tncx.jpg}
    \caption{Terminal Network Controller TNC-X. Source: \cite{tncx}}
    \label{tncx}
\end{figure}



\chapter{Similar missions and designs}
In this section, three already flown satellite missions are described: PW-Sat, SwissCube and MOVE-I. 
\section{PW-Sat}
First polish satellite, PW-Sat, was launched in year \si{2012}. It was build on Warsaw Univeristy of Technology, with Space Research Centre PAS support. 

PW-Sat used ISIS TRXUV on-board communication module, with two (UHF uplink + VHF downlink) dipoles. Used modulations were AFSK \SI{1200}{\bps}. Radio transmit output power was \SI{30}{\dBm}. 
Ground station was built on Nicolaus Copernicus Astronomical Center in Warsaw, using \si{4}, \si{9}~element synphase cross-yagi VHF antennas for downlink and \si{4}, \si{19}~element synphase cross-yagi UHF antennas for uplink. Peak output power for uplink was \SI{1500}{\watt}.

PW-Sat and its ground station antennas are shown in the figures \ref{CAMK_pic}, \ref{PW-Sat1_pic}.

\begin{minipage}{\linewidth}
    \centering
    \begin{minipage}{0.45\linewidth}
        \begin{figure}[H]
            \centering
            \includegraphics[width=0.32\paperwidth]{img/1/camk_pic.jpg}
            \caption{Nicolaus Copernicus Astronomical Center in Warsaw. PW-Sat antennas on the right. Source: \cite{camk_pic}}
            \label{CAMK_pic}
        \end{figure}
    \end{minipage}
    \hspace{0.05\linewidth}
    \begin{minipage}{0.45\linewidth}
        \begin{figure}[H]
            \centering
            \includegraphics[width=0.32\paperwidth]{img/1/pw-sat1.jpg}
            \caption{PW-Sat1. Source: \cite{pwsat1_pic}}
            \label{PW-Sat1_pic}
        \end{figure}
    \end{minipage}
\end{minipage}

\section{SwissCube}
SwissCube is the first Swiss satellite, launched in

